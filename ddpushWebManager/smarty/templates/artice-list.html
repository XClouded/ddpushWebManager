<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<!--[if lt IE 9]>
<script type="text/javascript" src="http://libs.useso.com/js/html5shiv/3.7/html5shiv.min.js"></script>
<script type="text/javascript" src="http://libs.useso.com/js/respond.js/1.4.2/respond.min.js"></script>
<script type="text/javascript" src="http://cdn.bootcss.com/css3pie/2.0beta1/PIE_IE678.js"></script>
<![endif]-->
<link type="text/css" rel="stylesheet" href="{#$base_path#}css/H-ui.css"/>
<link type="text/css" rel="stylesheet" href="{#$base_path#}css/H-ui.admin.css"/>
<link type="text/css" rel="stylesheet" href="{#$base_path#}font/font-awesome.min.css"/>

<link rel="stylesheet" type="text/css" href="{#$base_path#}js/js/jBox.css">
<!--[if IE 7]>
<link href="http://www.bootcss.com/p/font-awesome/assets/css/font-awesome-ie7.min.css" rel="stylesheet" type="text/css" />
<![endif]-->
<title>游戏管理</title>
</head>
<body>
<nav class="Hui-breadcrumb"><i class="icon-home"></i> 首页 <span class="c-gray en">&gt;</span> 推送管理 <span class="c-gray en">&gt;</span> 推送管理 <a class="btn btn-success radius r mr-20" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" ><i class="icon-refresh"></i></a></nav>
<div class="pd-20">
  <div class="text-c">
    <input type="text" name="" placeholder=" 用户ID、UUID " style="width:250px" class="input-text"><button name="" class="btn btn-success" type="submit"><i class="icon-search"></i> 搜索用户</button>
  </div>
  <div class="cl pd-5 bg-1 bk-gray mt-20"> 
    <span class="l">
      <!-- <a href="javascript:;" onclick="datadel()" class="btn btn-danger radius">
        <i class="icon-trash"></i> 批量删除
      </a>  -->

      </a>
    </span> 

    </span> 
  </div>
  <table class="table table-border table-bordered table-bg table-hover table-sort">
      <thead>
      <tr class="text-c">
          <th width="25"><input type="checkbox" name="" value=""></th>
          <th width="80">ID</th>
          <th width="250">UUID</th>
          <th width="150">昵称</th>
          <th width="100">设备类型</th>
          <th width="100">状态</th>
          <th width="130">推送个数</th>
          <th width="130">操作</th>
          <th width="130">推送状态</th>
      </tr>
      </thead>
      <!--  'id'=>10000, 'uuid'=>'cfcd208495d565ef66e7dff9f98764da', 'nickname'=>'小明', 'dev_type'=>1,'status'=>0, 'push_count'=>0 -->
      <tbody>
      {#foreach $user_list as $user#}

      <tr class="text-c">
          <td><input type="checkbox" value="1" name=""></td>
          <td>{#$user.id#}</td>
          <td>{#$user.uuid#}</td>
          <td>{#$user.nickname#}</td>
          <td>
              <!-- 设备类型  -->
              {#if $user.dev_type==0#}
              IOS
              {#elseif $user.dev_type==1#}
              Android
              {#else#}
              PC
              {#/if#}
          </td>
          <td>
              <!-- 状态 -->
              {#if $user.status==1#}
                <span class="label label-success" >
                    在线
                </span>
              {#else#}
              <span class="label label-disable">
                离线
              </span>
              {#/if#}
          </td>
          <td class="">
              <!--个数-->
              {#$user.push_count#}
          </td>
          <td>
              <button class="button radius btn-success" onclick="layer_show('650','','推送消息 目标ID:{#$user.id#}','push_message.php?id={#$user.id#}&uuid={#$user.uuid#}')">推送消息</button>
          </td>

          <td>
              <label class="button radius btn-success">已下发推送</label>
          </td>
      </tr>

      {#/foreach#}
      </tbody>
          <!--<td class="f-14">-->
            <!--{#if $game.status==1#}-->
              <!--<span class="btn radius btn-warning" onclick="changestatus(0, '下架', '{#$game.game_name#}', {#$game.id#});">-->
                <!--&lt;!&ndash; <span class="label label-success"> &ndash;&gt;-->
                <!--下架-->
              <!--</span>-->
            <!--{#else#}-->
              <!--<span class="btn radius btn-success" onclick="changestatus(1, '上架', '{#$game.game_name#}', {#$game.id#});">-->
                <!--上架-->
              <!--</span>-->
            <!--{#/if#}-->
          <!--</td>-->
          <!--<td class="f-14">-->
              <!--&lt;!&ndash; 测试 &ndash;&gt;-->
              <!--<span class="btn radius btn-success" onclick="testrequest('{#$game.game_name#}', {#$game.id#});">-->
                <!--测试-->
              <!--</span>-->
          <!--</td>-->
        <!--</tr>-->
    <!--</tbody>-->
  </table>
  <div id="pageNav" class="pageNav"></div>
</div>
<!-- <script type="text/javascript" src="http://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script> -->
<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
<script type="text/javascript" src="{#$base_path#}layer/layer.min.js"></script> 
<script type="text/javascript" src="{#$base_path#}js/pagenav.cn.js"></script> 
<script type="text/javascript" src="{#$base_path#}plugin/My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript" src="{#$base_path#}js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="{#$base_path#}js/H-ui.js"></script> 
<script type="text/javascript" src="{#$base_path#}js/H-ui.admin.js"></script> 
<script type="text/javascript" src="{#$base_path#}js/js/jBox.min.js"></script>
<link rel="stylesheet" type="text/css" href="{#$base_path#}js/js/jBox.css">

<script type="text/javascript">

function changestatus(st, msg, name, gid)
{
  //alert("status:" + st + "  id:" + gid + "  name:" + name);
  //if( confirm("确定要" + msg + name + "么?") )
  //{
    //开始改变状态
    //ajaxChangeStatus(st, msg, gid);
  //}
  var confirmBox = new jBox('Confirm',
     {
        confirmButton: "确定",
        cancelButton:"取消",
        confirm: function()
        {
            confirmBox.close();
            ajaxChangeStatus(st, msg, gid);
        }
      });
  confirmBox.setContent("确定要" + msg + name + "么?");
  confirmBox.open();
}

function ajaxChangeStatus(st, msg, gid)
{
    $.post('game_change_status.php', 
    {
      status:st,
      id:gid
    },
    function(data, status)
    {
      //alert("status:" + status + "   data:" + data);

      // var tipModuleBox = new jBox('Module',
      //   {
      //     title:'提示'
      //   });

      // if( data == 1 )
      // {
      //   //alert(msg + "成功!");
      //   tipModuleBox.setContent(msg + "成功!");
      // }
      // else
      // {
      //   //alert(msg + "失败!");
      //   tipModuleBox.setContent(msg + "失败!");
      // }
      // tipModuleBox.open();
      window.location.reload();
    });
}


function testrequest( name, gid )
{

  var myModule = new jBox('Modal',
    {
      title:'测试',
      content:'正在请求目标地址...',
      overlay:true
    });
  
  myModule.open();

  ajaxRequest( name, gid, myModule);
}

function ajaxRequest( name, gid, myModule )
{
  var urls = "test_game_status.php?id=" + gid + "&name=" + name;
  $.get(urls, function(data, status)
    {
      //alert("" + data );
      myModule.setContent("" + data );
    });
  
}


// window.onload = (function(){
//     // optional set
//     pageNav.pre="&lt;上一页";
//     pageNav.next="下一页&gt;";
//     // p,当前页码,pn,总页面
//     pageNav.fn = function(p,pn){$("#pageinfo").text("当前页:"+p+" 总页: "+pn);};
//     //重写分页状态,跳到第三页,总页33页
//     pageNav.go(1,13);
// });
$('.table-sort').dataTable({
	"lengthMenu":true,//显示数量选择 
	"bFilter": true,//过滤功能
	"bPaginate": true,//翻页信息
  //"sPaginationType":'full_numbers',
	//"bInfo": true,//数量信息
  "bLengthChange":true,
  "aLengthMenu":[10, 25, 50, 100],
	"aaSorting": [[ 1, "desc" ]],//默认第几个排序
	"bStateSave": true,//状态保存
	"aoColumnDefs": [
	  //{"bVisible": false, "aTargets": [ 3 ]} //控制列的隐藏显示
	  {"orderable":false,"aTargets":[0,2, 3, 4, 5, 6, 7]}// 制定列不参与排序
	]
});
</script>
</body>
</html>